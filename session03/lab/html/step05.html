
<!DOCTYPE html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />

  <title> Lab 3: Part (A) - CoffeeMate Refactored - CoffeeMate 2.0 </title>
  
    <style type="text/css">
    table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
      margin: 0; padding: 0; vertical-align: baseline; border: none; }
    table.sourceCode { width: 100%; line-height: 100%; }
    td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
    td.sourceCode { padding-left: 5px; }
    code > span.kw { color: #007020; font-weight: bold; }
    code > span.dt { color: #902000; }
    code > span.dv { color: #40a070; }
    code > span.bn { color: #40a070; }
    code > span.fl { color: #40a070; }
    code > span.ch { color: #4070a0; }
    code > span.st { color: #4070a0; }
    code > span.co { color: #60a0b0; font-style: italic; }
    code > span.ot { color: #007020; }
    code > span.al { color: #ff0000; font-weight: bold; }
    code > span.fu { color: #06287e; }
    code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  
  <link rel="stylesheet" href="./style/bootstrap.min.css" type="text/css">  
  <link rel="stylesheet" href="./style/clarity.css" type="text/css"> 

  <link rel="stylesheet" href="./style/highlight.css">
  <script src="./style/highlight.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>

<body>
  <div class="container-fluid">

    <!----------------------------------------------------------------------------------------->
   <style> body  { padding-top: 60px; } </style>    <div class="navbar navbar-fixed-top">
      <p id="title">Lab 3: Part (A) - CoffeeMate Refactored - CoffeeMate 2.0&nbsp;&nbsp;</p>
      <div class="navbar-inner">
        <ul class="nav">
          <li><a href="objectives.html">Objectives</a></li>
          <li><a href="step01.html">01</a></li>
          <li><a href="step02.html">02</a></li>
          <li><a href="step03.html">03</a></li>
          <li><a href="step04.html">04</a></li>
          <li class="active"><a href="step05.html">05</a></li>
          <li><a href="step06.html">06</a></li>
          <li><a href="step07.html">07</a></li>
          <li><a href="exercises.html">Exercises</a></li>
        </ul>
        <p class="navbar-text pull-right"> <a href="http://www.jumpyjosh.com/wit/androidy5/practicals/default.html"> Mobile Application Development 'MAD'</a> &nbsp; &nbsp;</p>
      </div>
    </div>
    <!----------------------------------------------------------------------------------------->


<h1 id="our-new-look-home-screen---edit-a-coffee">Our 'new look' Home Screen - Edit a Coffee</h1>
<p>The user now has the ability to delete (or remove) a coffee from the list of coffees displayed. But what if the user wants to update some of the coffees details? Maybe make it one of his or hers favourite coffees? That's what this step is about, so we'll be taking a similar approach as the previous step, but implementing a slightly different kind of Listener.</p>
<h1 id="editing-a-coffee">Editing a Coffee</h1>
<p>To give the user the option of Editing a coffee (by pressing the full row) we first need to &quot;listen&quot; for such an event, so we need to attach a Listener that 'listens' for individual row click events, and not just an element of the row.</p>
<p>If you remember from the previous step, our <b>CoffeeFragment</b> was responsible for handling 'delete' events, so naturally, this class will also manage any updates or edits the user wants to make.</p>
<p>Open your <b>CoffeeFragment.java</b> and override the <b><i>onListItemClick()</i></b> method - this will execute everytime a user selects a single row (or listItem) in the list, so this is where you need to</p>
<ul>
<li><p>find out which coffee was selected (and it's 'ID')</p></li>
<li><p>launch another activity so we can update the selected coffee</p></li>
<li><p>make sure the change to our coffee is reflected in our coffeeList</p></li>
</ul>
<p>We need to use <b>Bundles</b> and <b>Intents</b> and specifically, the first two parts are partially achieved as follows:</p>
<pre class="sourceCode java"><code class="sourceCode java">    Bundle activityInfo = <span class="kw">new</span> <span class="fu">Bundle</span>(); <span class="co">// Creates a new Bundle object</span>
    activityInfo.<span class="fu">putInt</span>(<span class="st">&quot;coffeeID&quot;</span>, <span class="co">/* pass in the coffees id here */</span>);
    
    Intent goEdit = <span class="kw">new</span> <span class="fu">Intent</span>(<span class="fu">getActivity</span>(), Edit.<span class="fu">class</span>); <span class="co">// Creates a new Intent</span>
    <span class="co">/* Add the bundle to the intent here */</span>
    <span class="fu">getActivity</span>().<span class="fu">startActivity</span>(goEdit); <span class="co">// Launch the Intent</span></code></pre>
<p>Have a go at completing the above as best you can.</p>
<p>Once you have that done, the rest of the work we need to do is carried out in the <b>Edit</b> Activity class so firstly, have a look at the <b><i>onCreate()</i></b> method - there's some code already in there, but if you try and run the app, it'll crash.</p>
<p>Any ideas why??</p>
<p>The first thing to do is setup the correct view for the activity - this is done using the <b><i>setContentView()</i></b> method, so see can you implement that, without referring to the solution below.</p>
<p>Also you need to 'bind' to and setup event handling on <i>favouriteImage</i> in the xml to avoid a NullPointerException, as follows:</p>
<pre class="sourceCode xml"><code class="sourceCode xml">android:onClick=&quot;toggle&quot;</code></pre>
<pre class="sourceCode java"><code class="sourceCode java">favouriteImage = (ImageView) <span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">favouriteImageView</span>);</code></pre>
<p>and you need to retrieve the 'coffeeID' from the Bundle, and get the coffee from our list using the <b><i>getCoffeeObject()</i></b> helper method - once again, try and have a go at this without referring to the solution code below:</p>
<p>(and here it is!)</p>
<pre class="sourceCode java"><code class="sourceCode java">  <span class="fu">setContentView</span>(R.<span class="fu">layout</span>.<span class="fu">edit</span>);
    
  activityInfo = <span class="fu">getIntent</span>().<span class="fu">getExtras</span>();
  aCoffee = <span class="fu">getCoffeeObject</span>(activityInfo.<span class="fu">getInt</span>(<span class="st">&quot;coffeeID&quot;</span>));

  favouriteImage = (ImageView) <span class="fu">findViewById</span>(R.<span class="fu">id</span>.<span class="fu">favouriteImageView</span>);</code></pre>
<p>Now if you run your app, and select a row, you should launch the 'Edit' Screen.</p>
<div class="figure">
<img src="../img/lab0309.png" />
</div>
<p>However, there's nothing to edit - so that's the next step - displaying the coffee data so we can change it.</p>


      <!----------------------------------------------------------------------------------------->
      <div id="footer">
        <p id="footertext">
          Prepared by  David Drohan (ddrohan@wit.ie). Except where otherwise noted, this content is licensed under a 
          <a class="externalLink" href="http://creativecommons.org/licenses/by-nc/3.0/" 
            title="External link to http://creativecommons.org/licenses/by-nc/3.0/" 
            target="_blank">Creative Commons Attribution-NonCommercial 3.0 License
          </a>
        </p>
      </div>

    </div>
  </body>
</html>
 
